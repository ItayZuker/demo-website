import React, {useContext} from "react";
import {GlobalContext} from "../../../../../../../../../../../../context/global-context";
import "./invitation-edit-header-repeat.scss";

const InvitationEditHeaderRepeat = (props) => {

    const {
        setDetails
    } = useContext(GlobalContext)

    const updateInvitations = (data) => {
        setDetails(prevState => {
            return {...prevState,
                invitations: data.invitations
            }
        })
    }

    const handleError = () => {
        props.setError(true)
    }

    const handleData = (data) => {
        if (data.success) {
            updateInvitations(data)
        } else {
            handleError()
        }
    }

    const updateRepeat = async (repeat) => {
        try {
            const token = window.localStorage.getItem("token");
            const res = await fetch("/profile-view/update-repeat-invitation", {
                method: "PUT",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    token: token,
                    invitationId: props.data.collectionId,
                    repeat: repeat
                }),
            });
            const data = await res.json();
            handleData(data);
        } catch (err) {
            handleError()
        }
    }

    const clickRepeatIcon = () => {
        if (props.data.repeat) {
            updateRepeat(false)
        } else {
            updateRepeat(true)
        }
    }

    return (
        <div
            onClick={() => clickRepeatIcon()}
            className="invitation-edit-header-repeat-container">
            {props.data.repeat
                ?   <svg className="repeat" width="116" height="116" viewBox="0 0 116 116" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M49.4 99.09C30.55 95.08 16.51 78.27 16.01 59.12C15.79 50.82 18.06 42.76 22.32 35.87C22.68 35.29 23.05 34.72 23.43 34.16C23.81 33.6 24.2 33.05 24.61 32.52L26.04 33.94L27.48 35.38L36.45 44.35C38.4 46.3 40.87 46.25 42.54 45.56C44.21 44.87 45.99 43.15 45.99 40.4V5.59C45.99 2.51 43.48 0 40.4 0H5.6C2.85 0 1.13 1.78 0.439995 3.45C-0.250005 5.12 -0.300005 7.59 1.65 9.54L10.4 18.29L11.81 19.7L13.25 21.14C12.82 21.66 12.41 22.19 12 22.72C11.59 23.26 11.2 23.8 10.81 24.35C3.38 34.79 -0.520005 47.54 0.0599953 60.62C1.22 87.1 20.22 109.38 46.26 114.8C48.45 115.26 50.67 114.8 52.49 113.49C54.33 112.18 55.51 110.23 55.8 107.99C56.35 103.81 53.6 99.98 49.4 99.09V99.09Z" fill="black"/>
                        <path d="M105.2 91.66C112.12 81.9399 116 70.1899 116 57.9999C116 30.3599 96.35 6.41995 69.27 1.08995C67.01 0.639946 64.68 1.23995 62.88 2.70995C61.05 4.20995 60 6.43995 60 8.79995V9.12995C60 12.8999 62.66 16.0699 66.46 16.8499C85.89 20.8299 100 38.1299 100 57.9999C100 66.0099 97.79 73.62 93.71 80.16C93.35 80.74 92.98 81.3099 92.59 81.8699C92.21 82.4199 91.8 82.9599 91.39 83.4999L89.95 82.0599L88.54 80.6499L79.54 71.6499C78.34 70.4499 76.93 69.9999 75.64 69.9999C74.84 69.9999 74.08 70.1699 73.45 70.4299C71.78 71.1199 70 72.8399 70 75.5899V110.4C70 113.48 72.51 115.99 75.59 115.99H110.4C113.15 115.99 114.87 114.21 115.56 112.54C116.25 110.87 116.3 108.4 114.35 106.45L105.59 97.6899L104.19 96.2899L102.76 94.8599C103.19 94.3399 103.59 93.8099 104 93.2699C104.41 92.7299 104.82 92.1999 105.21 91.6499L105.2 91.66Z" fill="black"/>
                    </svg>
                :   <svg className="no-repeat" width="116" height="116" viewBox="0 0 116 116" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M105.2 91.66C112.12 81.94 116 70.19 116 58C116 46.45 112.56 35.55 106.59 26.38C106.22 25.81 105.84 25.25 105.45 24.69C105.06 24.14 104.67 23.59 104.26 23.05L105.7 21.61L107.1 20.21L111.64 15.67C116.15 11.16 117.29 4.95 114.17 1.83C112.98 0.64 111.34 0.07 109.51 0.07C106.55 0.07 103.12 1.57 100.33 4.36L95.8 8.89L94.38 10.31L92.95 11.74C92.41 11.33 91.87 10.93 91.32 10.55C90.77 10.16 90.21 9.78 89.64 9.4C83.58 5.44 76.7 2.56 69.27 1.1C67.01 0.65 64.68 1.25 62.88 2.72C61.05 4.22 60 6.45 60 8.81V9.14C60 12.91 62.66 16.08 66.46 16.86C70.56 17.7 74.42 19.14 77.97 21.07C78.58 21.4 79.18 21.74 79.77 22.1C80.35 22.46 80.93 22.82 81.49 23.21L80.06 24.64L78.6 26.1L26.15 78.53L24.68 80L23.28 81.4C22.9 80.84 22.53 80.26 22.17 79.68C21.81 79.09 21.46 78.5 21.13 77.89C18.02 72.21 16.19 65.81 16.01 59.11C15.79 50.81 18.06 42.75 22.32 35.86C22.68 35.28 23.05 34.71 23.43 34.15C23.81 33.59 24.2 33.04 24.61 32.51L26.03 33.93L27.47 35.37L36.44 44.34C38.39 46.29 40.86 46.24 42.53 45.55C44.2 44.86 45.98 43.14 45.98 40.39V5.59C45.98 2.51 43.47 0 40.39 0H5.6C2.85 0 1.13 1.78 0.439995 3.45C-0.250005 5.12 -0.300005 7.59 1.65 9.54L10.4 18.29L11.81 19.7L13.25 21.14C12.82 21.66 12.41 22.19 12 22.72C11.59 23.26 11.2 23.8 10.81 24.35C3.38 34.79 -0.520005 47.54 0.0599953 60.62C0.529995 71.25 3.87 81.19 9.39 89.65C9.76 90.22 10.14 90.78 10.53 91.33C10.92 91.88 11.32 92.43 11.72 92.96L10.35 94.33L8.85999 95.82L4.35 100.33C-0.160005 104.84 -1.3 111.05 1.82 114.17C4.94 117.29 11.15 116.15 15.66 111.64L20.18 107.12L21.66 105.64L23.04 104.26C23.58 104.67 24.12 105.07 24.68 105.45C25.24 105.84 25.79 106.22 26.36 106.59C32.29 110.45 39 113.27 46.25 114.78C48.44 115.24 50.66 114.78 52.48 113.47C54.32 112.16 55.5 110.21 55.79 107.97C56.34 103.79 53.59 99.96 49.39 99.07C45.37 98.22 41.57 96.77 38.08 94.86C37.47 94.53 36.87 94.19 36.29 93.82C35.71 93.46 35.14 93.09 34.58 92.7L36 91.28L37.46 89.82L89.9 37.39L91.37 35.92L92.79 34.5C93.17 35.07 93.54 35.64 93.89 36.23C94.25 36.82 94.59 37.42 94.92 38.03C98.17 44.01 100 50.83 100 57.98C100 65.99 97.79 73.6 93.71 80.14C93.35 80.72 92.98 81.29 92.59 81.85C92.21 82.4 91.8 82.94 91.39 83.48L89.95 82.04L88.54 80.63L79.54 71.63C78.34 70.43 76.93 69.98 75.64 69.98C74.84 69.98 74.08 70.15 73.45 70.41C71.78 71.1 70 72.82 70 75.57V110.38C70 113.46 72.51 115.97 75.59 115.97H110.4C113.15 115.97 114.87 114.19 115.56 112.52C116.25 110.85 116.3 108.38 114.35 106.43L105.59 97.67L104.19 96.27L102.76 94.84C103.19 94.32 103.59 93.79 104 93.25C104.41 92.71 104.82 92.18 105.21 91.63L105.2 91.66Z" fill="black"/>
                    </svg>
            }
        </div>
    )
}

export default InvitationEditHeaderRepeat